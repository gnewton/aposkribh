%!PS-Adobe-2.0 EPSF-1.2
%%Title:
%%Creator:Glen Newtopn

/iget{  %false d# /Value
    /.key exch def
    /.ddict# exch def

    .ddict# .key known{
        pop
        .ddict# .key get
    }if
}bind def


/PathFiller{
    5 dict begin
    (/PathFiller START) =
    /pathProc exch def
    /fillerArgs# exch def

    gsave
    pathProc
    
    clip

    fillerArgs# /FillerProcArgs known{
        fillerArgs# /Rotate get rotate
    }if
    
    fillerArgs# /AlphaStroke known{
        fillerArgs# /AlphaStroke get   .setstrokeconstantalpha
    }if

    fillerArgs# /AlphaFill known{
        fillerArgs# /AlphaFill get   .setfillconstantalpha
    }if

    fillerArgs# /FillerProc get exec
    grestore
    end
    (/PathFiller END) =
}bind def

/testShape{
    newpath
    100 100 moveto
    200 10 rlineto
    10 200 rlineto
    -30 0 rlineto
    -50 10 rlineto
    closepath
}def


/StripesFillerProc{

    pathbbox
    /y1 exch cvi def
    /x1 exch cvi def
    /y0 exch cvi def
    /x0 exch cvi def

    gsave

    1 0 0 setrgbcolor
    newpath
    x0 y0 moveto
    x1 y1 lineto
    stroke
    grestore

    fillerArgs# /FillerProcArgs get /LineWidth get setlinewidth
    fillerArgs# /FillerProcArgs get /Color get exec setrgbcolor

    
    x0 fillerArgs# /FillerProcArgs get /StepSize get  x1{
        /x exch def
         newpath
         x y0 moveto
         x y1 lineto
         stroke
    }for

}def

<<
    /Rotate 15
    /AlphaStroke .4
    /FillerProc {
        StripesFillerProc
    }
    /FillerProcArgs
    <<
        /StepSize 7
        /LineWidth 3
        /Color {0 0 1}
    >>
>>
{
    testShape
}
PathFiller

    testShape
stroke

<<
    /Rotate 0
    /AlphaStroke .4
    
    /FillerProc {
        StripesFillerProc
    }
    /FillerProcArgs
    <<
        /StepSize 7
        /LineWidth 3
        /Color {0 1 0}
    >>
>>
{
    testShape
}
PathFiller

showpage
%%%%%%%%%%%%%%%%%%%%%%%%



/PathRender{
    (/PathRender START) =
    5 dict begin
    /pathProc exch def
    /renderArgs# exch def

    /n 1 renderArgs# /Repeat iget def
    /beforeLoop { (BeforeLoop) =} renderArgs# /BeforeLoop iget def
    /afterLoop  { } renderArgs# /AfterLoop iget def

    /beforeIter { } renderArgs# /BeforeIter iget def
    /afterIter  { } renderArgs# /AfterIter iget def

    beforeLoop 

    n {
        gsave
        beforeIter
        
        pathProc
        
        renderArgs# /movetoProc get
        renderArgs# /linetoProc get
        renderArgs# /curvetoProc get
        renderArgs# /closeProc  get
        pathforall
        afterIter
        grestore

    }repeat
    afterLoop
    end

    (/PathRender END) =
}bind def

showpage

(8888888888888) =
<<
    /movetoProc  {moveto}
    /linetoProc  {lineto}
    /curvetoProc {curveto}
    /closeProc   {closepath}
    %
>>
%{
(testShape)
%}
PathRender
(8888888888888) =
showpage


/TT
<<
    /BeforeLoop{
        /movetoRandom renderArgs# /MovetoRandom  get def
    }
    /MovetoRandom 500
    /Repeat 50
    /BeforeLoop {

    }

    /AfterIter {
        stroke
    }
    /BeforeIter {
        .1 .setstrokeconstantalpha
        %4 setlinewidth
        rand 7 mod setlinewidth

        rand 100 mod 100.0 div
        rand 100 mod 100.0 div
        rand 100 mod 100.0 div
          setrgbcolor
    }
    /movetoProc
    {
        newpath
        /y exch def
        /x exch def
        x  rand movetoRandom mod add
        y  rand movetoRandom mod add 
        moveto
    }

    /linetoProc
    {
        /y exch def
        /x exch def
        x rand movetoRandom mod add
        y rand movetoRandom mod add
        lineto
    }    

    /curvetoProc
    {
        /y3 exch def
        /x3 exch def
        /y2 exch def
        /x2 exch def
        /y1 exch def
        /x1 exch def
        x1  rand movetoRandom mod add
        y1  rand movetoRandom mod add 
        x2  rand movetoRandom mod add
        y2  rand movetoRandom mod add 
        x3  rand movetoRandom mod add
        y3  rand movetoRandom mod add 
        curveto
    }
    /closeProc
    {
        closepath
    }
>> def

TT
{
    testShape
}
PathRender

showpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
/randomShapes{
    /d 30 def
    /d2 d 2 div def
    10 10 moveto

    30{
        rand d mod d2 sub
        rand d mod d2 sub
        rlineto
    }repeat

}bind def


TT
{
    randomShapes
}PathRender

showpage

<<
    /FillerProc {
        TT
        {
            randomShapes
        }PathRender
    }
    /FillerArg1 (MMM)
>>
{
    testShape
}
PathFiller

showpage
